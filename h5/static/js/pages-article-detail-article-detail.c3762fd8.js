(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-article-detail-article-detail"],{"0542":function(t,e,i){"use strict";var n,o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"content animated fast fadeIn"},[i("v-uni-view",{staticClass:"article_info"},[i("v-uni-view",{staticClass:"ueser pd-2"},[i("v-uni-view",{staticClass:"ueser_left flex"},[i("v-uni-view",{staticClass:"user_image"},[i("v-uni-image",{staticClass:"image",attrs:{src:t.item.userpic,mode:"","lazy-load":!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openSpace(t.item.user_id)}}}),i("v-uni-view",{staticClass:"user_mess"},[i("v-uni-text",{staticStyle:{"font-size":"28rpx","line-height":"1.5"}},[t._v(t._s(t.item.username?t.item.username:""))]),i("v-uni-text",{staticStyle:{color:"#9d9589","font-size":"20rpx","line-height":"1.5"}},[t._v(t._s(t._f("formatTime")(t.item.newstime)))])],1)],1)],1),i("v-uni-view",{staticClass:"ueser_right"},[0!==t.user.role&&t.loginStatus?i("v-uni-text",{staticClass:"button animated faster my-10",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deletePost(t.item.id)}}},[t._v("删除")]):t._e(),t.item.isFollow||t.user.id===t.item.user_id?t._e():i("v-uni-view",{staticClass:"button animated faster",attrs:{"hover-class":"jello"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.follow.apply(void 0,arguments)}}},[t._v(t._s(t.item.isFollow?"已关注":"关注"))])],1)],1),i("v-uni-view",{staticClass:"article_title",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openDetail.apply(void 0,arguments)}}},[i("v-uni-text",{staticStyle:{"font-size":"30rpx"}},[t._v(t._s(t.item.title))])],1),t._t("default",[t.item.titlepic?i("v-uni-view",{staticClass:"article_image",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openDetail.apply(void 0,arguments)}}},[i("v-uni-image",{staticStyle:{width:"100%",height:"350rpx"},attrs:{src:t.item.titlepic,mode:"aspectFit"}})],1):t._e()]),i("v-uni-view",{staticClass:"article_details"},[i("v-uni-view",{staticClass:"flex animated faster",class:"support"==t.item.support.type?"active":"",staticStyle:{flex:"1"},attrs:{"hover-class":"jello font-color"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doSupport("support")}}},[i("v-uni-text",{staticClass:" iconfont"},[t._v("")]),i("v-uni-text",[t._v(t._s(t.item.support.support_count>0?t.item.support.support_count:"点赞"))])],1),i("v-uni-view",{staticClass:"flex  animated faster",class:"unsupport"==t.item.support.type?"active":"",staticStyle:{flex:"1"},attrs:{"hover-class":"jello font-color"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doSupport("unsupport")}}},[i("v-uni-text",{staticClass:" iconfont"},[t._v("")]),i("v-uni-text",[t._v(t._s(t.item.support.unsupport_count>0?t.item.support.unsupport_count:"点灭"))])],1),i("v-uni-view",{staticClass:"flex  animated faster",staticStyle:{flex:"1"},attrs:{"hover-class":"jello font-color"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doComment.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:" iconfont"},[t._v("")]),i("v-uni-text",[t._v(t._s(t.item.comment_count>0?t.item.comment_count:"评论"))])],1),i("v-uni-view",{staticClass:"flex animated faster",staticStyle:{flex:"1"},attrs:{"hover-class":"jello font-color"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doShare.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:" iconfont"},[t._v("")]),i("v-uni-text",[t._v(t._s(t.item.share_num>0?t.item.share_num:"分享"))])],1)],1)],2)],1)],1)},s=[];i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}))},"0bcd":function(t,e,i){var n=i("4619");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("4f06").default;o("20260275",n,!0,{sourceMap:!1,shadowMode:!1})},"20ed":function(t,e,i){var n=i("9e3d");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("4f06").default;o("71782c3b",n,!0,{sourceMap:!1,shadowMode:!1})},"30e3":function(t,e,i){"use strict";i.r(e);var n=i("bd31"),o=i("6a69");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("9283");var a,r=i("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"4a040cae",null,!1,n["a"],a);e["default"]=u.exports},4619:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,".ueser[data-v-7f5b8bf1]{\n\t\t/* padding: 20rpx; */display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.ueser_right[data-v-7f5b8bf1]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.user_mess[data-v-7f5b8bf1]{\n\t\t/* padding: 10rpx; */display:-webkit-box;display:-webkit-flex;display:flex;padding-left:%?20?%;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;align-items:flex-start}.user_image[data-v-7f5b8bf1]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.image[data-v-7f5b8bf1]{width:%?65?%;height:%?65?%;border-radius:100%}.button[data-v-7f5b8bf1]{width:%?90?%;height:%?50?%;display:-webkit-box;display:-webkit-flex;display:flex;border-radius:10%;background-color:#16c2c2;color:#fff;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.article_title[data-v-7f5b8bf1]{padding:0 %?20?%}.article_details[data-v-7f5b8bf1]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.iconfont[data-v-7f5b8bf1]{margin-right:%?20?%;font-size:%?30?%}.active[data-v-7f5b8bf1]{color:#16c2c2}",""]),t.exports=e},"5b07":function(t,e,i){"use strict";i.r(e);var n=i("8578"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},"6a69":function(t,e,i){"use strict";i.r(e);var n=i("ddbd"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},"6cd6":function(t,e,i){"use strict";var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("8e6e"),i("ac6a"),i("456d"),i("20d6");var o=n(i("bd86"));i("c5f6");var s=n(i("7e22")),a=(n(i("e43a")),i("2f62"));function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){(0,o.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var c={props:{item:Object,index:{type:Number,default:-1},isdetail:{type:Boolean,default:!1}},computed:u({},(0,a.mapState)({user:function(t){return t.user},loginStatus:function(t){return t.loginStatus}})),filters:{formatTime:function(t){return s.default.gettime.gettime(t)}},data:function(){return{readNum:0}},mounted:function(){},methods:{openSpace:function(t){uni.navigateTo({url:"/pages/user-space/user-space?user_id="+t})},follow:function(){var t=this;this.checkAuth((function(){console.log(t.item),t.request.userfollow({follow_id:t.item.user_id},{token:!0}).then((function(e){uni.$emit("updateFollowOrSupport",{type:"follow",data:{user_id:t.item.user_id}})}))}))},openDetail:function(){var t=this;if(console.log("进入详情页"),!this.isdetail){uni.navigateTo({url:"/pages/article-detail/article-detail?detail="+JSON.stringify(this.item)});var e=uni.getStorageSync("history");e=e?JSON.parse(e):[];var i=e.findIndex((function(e){return e.id==t.item.id}));-1==i&&(e.unshift(this.item),uni.setStorageSync("history",JSON.stringify(e)))}},doSupport:function(t){var e=this;this.checkAuth((function(){var i={post_id:e.item.id,type:"support"===t?0:1};e.request.userSupport(i,{token:!0}).then((function(i){if(console.log(e.item),i.errorCode)return uni.showToast({title:i.msg,icon:"none"});uni.$emit("updateFollowOrSupport",{type:"support",data:{type:t,id:e.item.id}})}))}))},openCommentPage:function(){},deletePost:function(t){var e=this;t&&uni.showModal({title:"提示",content:"你确定要删除此帖子吗？",success:function(i){i.confirm&&e.request.deletePost({id:t}).then((function(e){"删除成功"==e.msg&&(uni.showToast({title:"删除成功",icon:"none"}),uni.$emit("updatedeletePost",{type:"follow",data:{id:t}}))}))}})},doComment:function(){var t=this;this.checkAuth((function(){if(!t.isdetail)return t.openDetail();t.$emit("doComment")}))},doShare:function(){var t=this;this.checkAuth((function(){if(!t.isdetail)return t.openDetail();t.$emit("doShare")}))}}};e.default=c},"777c":function(t,e,i){"use strict";i.r(e);var n=i("827d"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},"77f7":function(t,e,i){"use strict";i.r(e);var n=i("0542"),o=i("a368");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("bcc7");var a,r=i("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"7f5b8bf1",null,!1,n["a"],a);e["default"]=u.exports},8226:function(t,e,i){"use strict";var n,o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"fixed-bottom border-top bg-white",staticStyle:{height:"100rpx",display:"flex","align-items":"center"}},[i("v-uni-input",{staticClass:" flex-1 rounded bg-light ml-20",staticStyle:{padding:"5rpx"},attrs:{type:"text","confirm-type":"send",value:"",placeholder:"文明发言",focus:t.focus},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.$emit("blur")}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),i("v-uni-view",{staticClass:"iconfont flex font-md animated ",staticStyle:{width:"100rpx"},attrs:{"hover-class":"jello font-color"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("")])],1)},s=[];i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}))},"827d":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={props:{focus:{type:Boolean,default:!1}},data:function(){return{content:""}},methods:{submit:function(){if(""==this.content)return uni.showToast({title:"消息不能为空",icon:"none"});this.$emit("submit",this.content),this.content=""}}};e.default=n},8578:function(t,e,i){"use strict";var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("8e6e"),i("ac6a"),i("456d");var o=n(i("bd86")),s=n(i("77f7")),a=n(i("bcd1")),r=n(i("30e3")),u=n(i("7e22")),c=i("2f62");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){(0,o.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var p={components:{commonList:s.default,bootomInput:a.default,moreShare:r.default},onNavigationBarButtonTap:function(t){0===t.index&&this.$refs.share.open({title:this.info.title,shareText:this.info.title,href:"/page/article-detail/article-detail?",image:this.info.titlepic})},onBackPress:function(t){"backbutton"==t.from&&this.$refs.share.close()},data:function(){return{articleImage:[],focus:!1,reply_id:0,commonList:[],shareList:[{icon:"&#xe643;",iconColor:"uni-bg-green",name:"微信好友"},{icon:"&#xe680;",iconColor:"uni-bg-green",name:"微信朋友圈"},{icon:"&#xe683;",iconColor:"uni-bg-red",name:"新浪微博"},{icon:"&#xe60a;",iconColor:"uni-badge-primary",name:"QQ好友"}],info:{id:0,user_id:0,username:"",userImage:"",newstime:"",isFollow:!1,title:"",content:"",support:{type:"support",support_count:0,unsupport_count:0},comment_count:0,share_num:0}}},onLoad:function(t){var e=this;t.detail&&this.init(JSON.parse(t.detail)),uni.$on("updateFollowOrSupport",(function(t){switch(t.type){case"follow":e.follow(t.data.user_id);break;case"support":e.doSupport(t.data);break}})),uni.$on("updatedeletePost",(function(t){uni.navigateBack({delta:1}),e.getListData()}))},onUnload:function(){uni.$off("updateFollowOrSupport",(function(t){})),uni.$off("updatedeletePost",(function(t){}))},computed:f({},(0,c.mapState)({loginStatus:function(t){return t.loginStatus},user:function(t){return t.user}}),{imageList:function(){return this.articleImage.map((function(t){return t.url}))}}),methods:{init:function(t){var e=this;uni.setNavigationBarTitle({title:t.title}),this.info=t,this.info.content="",this.articleImage=[],this.request.getArticleDetailById(this.info.id).then((function(t){e.info.content=t.data.detail.content,e.articleImage=t.data.detail.images})),this.getComments()},doComment:function(){},doShare:function(){},follow:function(){this.info.isFollow=!0,uni.showToast({title:"关注成功"})},doSupport:function(t){if(this.info.support.type==t.type)return uni.showToast({title:"您已经操作过了",icon:"none"});t.type;if(""===this.info.support.type)return this.info.support.type=t.type,void this.info.support[t.type+"_count"]++;"support"===this.info.support.type&&"unsupport"===t.type?(this.info.support.support_count--,this.info.support.unsupport_count++):"unsupport"===this.info.support.type&&"support"===t.type&&(this.info.support.support_count++,this.info.support.unsupport_count--),this.info.support.type=t.type,"support"==t.type?uni.showToast({title:"👍",icon:"none"}):uni.showToast({title:"👎",icon:"none"})},preview:function(t){uni.previewImage({current:t,urls:this.imageList})},submit:function(t){var e=this;if(""==t)return uni.showToast({title:"评论不能为空",icon:"none"});uni.showLoading({title:"评论中",mask:!1});var i={fid:this.reply_id,data:t,post_id:this.info.id};this.request.comment(i,{token:!0}).then((function(t){console.log(t),uni.hideLoading(),e.getComments()})).catch((function(t){uni.hideLoading()}))},reply:function(t){this.reply_id=t,this.focus=!0},blur:function(){this.reply_id=0,this.focus=!1},getComments:function(){var t=this;this.request.getCommentByPostId(this.info.id).then((function(e){t.commonList=t.__ArrSort(e.data.list),t.info.comment_count=t.commonList.length,uni.$emit("updateCommentsCount",{id:t.info.id,count:t.info.comment_count})}))},__ArrSort:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=[],n=0,o=function t(e,n,o){for(var s=0;s<e.length;s++){var a=e[s];a.fid==n&&(a.lev=o,i.push({id:a.id,fid:a.fid,userid:a.user.id,userpic:a.user.userpic,username:a.user.username,time:u.default.gettime.gettime(a.create_time),data:a.data}),t(e,a.id,o+1))}};return o(t,e,n),i}}};e.default=p},9283:function(t,e,i){"use strict";var n=i("20ed"),o=i.n(n);o.a},"9e3d":function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,".comment[data-v-4a040cae]{width:%?100?%;height:%?100?%}",""]),t.exports=e},a368:function(t,e,i){"use strict";i.r(e);var n=i("6cd6"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},bcc7:function(t,e,i){"use strict";var n=i("0bcd"),o=i.n(n);o.a},bcd1:function(t,e,i){"use strict";i.r(e);var n=i("8226"),o=i("777c");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);var a,r=i("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"02795324",null,!1,n["a"],a);e["default"]=u.exports},bd31:function(t,e,i){"use strict";var n,o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("uni-popup",{ref:"popup",attrs:{type:"bottom"}},[i("v-uni-view",{staticClass:"text-center py-20 font-md border-bottom"},[t._v("分享到")]),i("v-uni-view",{staticClass:"flex"},t._l(t.providerList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"flex-1 flex flex-column py-20",attrs:{"hover-class":"bg-light"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.share(e)}}},[i("v-uni-view",{staticClass:"iconfont flex text-white  comment font-lger rounded-circle",class:e.iconColor},["微信好友"===e.name?i("v-uni-text",[t._v("")]):"微信朋友圈"===e.name?i("v-uni-text",[t._v("")]):"新浪微博"===e.name?i("v-uni-text",[t._v("")]):i("v-uni-text",[t._v("")])],1),i("v-uni-text",{staticClass:"font-small text-light-muted "},[t._v(t._s(e.name))])],1)})),1),i("v-uni-view",{staticClass:"text-center py-20 font-md border-top ",attrs:{"hover-class":"bg-light"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancel.apply(void 0,arguments)}}},[t._v("取消")])],1)},s=[];i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}))},c13c:function(t,e,i){"use strict";var n,o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("common-list",{attrs:{item:t.info,isdetail:!0},on:{follow:function(e){arguments[0]=e=t.$handleEvent(e),t.follow.apply(void 0,arguments)},doSupport:function(e){arguments[0]=e=t.$handleEvent(e),t.doSupport.apply(void 0,arguments)},doComment:function(e){arguments[0]=e=t.$handleEvent(e),t.doComment.apply(void 0,arguments)},doShare:function(e){arguments[0]=e=t.$handleEvent(e),t.doShare.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"pd-2"},[t._v(t._s(t.info.content))]),t._l(t.articleImage,(function(e,n){return i("v-uni-view",{key:n},[i("v-uni-image",{staticClass:"wd-100",attrs:{src:e.url,mode:"widthFix"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.preview(n)}}})],1)}))],2),i("divider"),i("v-uni-view",{staticClass:"pd-2 font-md font-weight-bold"},[t._v("最新评论"+t._s(t.commonList.length))]),i("v-uni-view",{staticClass:"px-20"},t._l(t.commonList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"uni-comment-list"},[e.fid?i("v-uni-view",{staticStyle:{width:"60rpx"}}):t._e(),i("v-uni-view",{staticClass:" wd-100",class:e.fid?"bg-light rounded pd-2":"",staticStyle:{display:"flex"}},[i("v-uni-view",{staticClass:"uni-comment-face"},[i("v-uni-image",{attrs:{src:e.userpic,mode:"widthFix"}})],1),i("v-uni-view",{staticClass:"uni-comment-body"},[i("v-uni-view",{staticClass:"uni-comment-top",staticStyle:{display:"flex","justify-content":"space-between"}},[i("v-uni-text",[t._v(t._s(e.username))]),0!==t.user.role&&t.loginStatus?i("v-uni-text",{staticClass:"text-right"},[t._v("删除")]):t._e()],1),i("v-uni-view",{staticClass:"uni-comment-content",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.reply(e.id)}}},[t._v(t._s(e.data))]),i("v-uni-view",{staticClass:"uni-comment-date"},[i("v-uni-view",[t._v(t._s(e.time))]),i("v-uni-view",{staticClass:"uni-comment-replay-btn"},[t._v("1回复")])],1)],1)],1)],1)})),1),i("v-uni-view",{staticStyle:{height:"100rpx"}},[i("bootom-input",{attrs:{focus:t.focus},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.blur.apply(void 0,arguments)},submit:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}})],1),i("more-share",{ref:"share"})],1)},s=[];i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}))},ddbd:function(t,e,i){"use strict";var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a481"),i("96cf");var o=n(i("3b8d"));i("55dd");var s=n(i("3065")),a={components:{uniPopup:s.default},data:function(){return{title:"share",shareText:"uni-app可以同时发布成原生App、小程序、H5，邀请你一起体验！",href:"https://uniapp.dcloud.io",image:"",shareType:1,providerList:[]}},computed:{isDisableButton:function(){return function(t){return 0===this.shareType&&"qq"===t.id||5===this.shareType&&"分享到微信好友"!==t.name}}},onShareAppMessage:function(){return{title:this.shareText?this.shareText:"欢迎体验uni-app",path:"/pages/tabBar/component/component",imageUrl:this.image?this.image:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/share-logo@3.png"}},beforeDestroy:function(){this.shareText="uni-app可以同时发布成原生App、小程序、H5，邀请你一起体验！",this.href="https://uniapp.dcloud.io",this.image=""},onReady:function(){var t=this;uni.getProvider({service:"share",success:function(e){for(var i=[],n=0;n<e.provider.length;n++)switch(e.provider[n]){case"weixin":i.push({name:"微信好友",id:"weixin",iconColor:"uni-bg-green",sort:0}),i.push({name:"微信朋友圈",id:"weixin",iconColor:"uni-bg-green",type:"WXSenceTimeline",sort:1});break;case"sinaweibo":i.push({name:"新浪微博",iconColor:"uni-bg-red",id:"sinaweibo",sort:2});break;case"qq":i.push({name:"QQ好友",iconColor:"uni-bg-blue",id:"qq",sort:3});break;default:break}t.providerList=i.sort((function(t,e){return t.sort-e.sort}))},fail:function(t){uni.showModal({content:"获取分享通道失败",showCancel:!1})}})},methods:{cancel:function(){this.$refs.popup.close()},open:function(t){this.title=t.title,this.shareText=t.shareText,this.href=t.href,this.image=t.image,this.$refs.popup.open()},close:function(){this.$refs.popup.close()},share:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("分享通道:"+e.id+"； 分享类型:"+this.shareType),this.shareText||1!==this.shareType&&0!==this.shareType){t.next=4;break}return uni.showModal({content:"分享内容不能为空",showCancel:!1}),t.abrupt("return");case 4:if(this.image||2!==this.shareType&&0!==this.shareType){t.next=7;break}return uni.showModal({content:"分享图片不能为空",showCancel:!1}),t.abrupt("return");case 7:"qq"!==e.id&&"sinaweibo"!=e.id||(this.shareType=1),i={provider:e.id,scene:e.type&&"WXSenceTimeline"===e.type?"WXSenceTimeline":"WXSceneSession",type:this.shareType,success:function(t){console.log("success",t),uni.showModal({content:"已分享",showCancel:!1})},fail:function(t){console.log("fail",t),uni.showModal({content:t.errMsg,showCancel:!1})},complete:function(){console.log("分享操作结束!")}},t.t0=this.shareType,t.next=0===t.t0?12:1===t.t0?17:2===t.t0?19:5===t.t0?21:25;break;case 12:return i.summary=this.shareText,i.imageUrl=this.image,i.title="欢迎体验uniapp",i.href="https://uniapp.dcloud.io",t.abrupt("break",26);case 17:return i.summary=this.shareText,t.abrupt("break",26);case 19:return i.imageUrl=this.image,t.abrupt("break",26);case 21:return i.imageUrl=this.image?this.image:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/share-logo@3.png",i.title="欢迎体验uniapp",i.miniProgram={id:"gh_33446d7f7a26",path:"/pages/tabBar/component/component",webUrl:"https://uniapp.dcloud.io",type:0},t.abrupt("break",26);case 25:return t.abrupt("break",26);case 26:if(0!==i.type||"iOS"!==plus.os.name){t.next=30;break}return t.next=29,this.compress();case 29:i.imageUrl=t.sent;case 30:1===i.type&&"qq"===i.provider&&(i.href="https://uniapp.dcloud.io",i.title="欢迎体验uniapp"),uni.share(i);case 32:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),compress:function(){console.log("开始压缩");var t=this.image;return new Promise((function(e){var i=plus.io.convertAbsoluteFileSystem(t.replace("file://",""));console.log("after"+i),plus.io.resolveLocalFileSystemURL(i,(function(i){i.file((function(i){console.log("getFile:"+JSON.stringify(i)),i.size>20480&&plus.zip.compressImage({src:t,dst:t.replace(".jpg","2222.jpg").replace(".JPG","2222.JPG"),width:"10%",height:"10%",quality:1,overwrite:!0},(function(i){console.log("success zip****"+i.size);var n=t.replace(".jpg","2222.jpg").replace(".JPG","2222.JPG");e(n)}),(function(t){uni.showModal({content:"分享图片太大,需要请重新选择图片!",showCancel:!1})}))}))}),(function(t){console.log("Resolve file URL failed: "+t.message),uni.showModal({content:"分享图片太大,需要请重新选择图片!",showCancel:!1})}))}))}}};e.default=a},ed06:function(t,e,i){"use strict";i.r(e);var n=i("c13c"),o=i("5b07");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);var a,r=i("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"12ce0c34",null,!1,n["a"],a);e["default"]=u.exports}}]);